{"version":3,"sources":["../../src/helpers.ts","../../src/hooks/useResponsiveSize.ts","../../src/hooks/useCanvasResolution.ts","../../src/index.tsx","../../src/hooks/useCanvasStyles.ts","../../src/hooks/useCanvasPaddings.ts","../../src/hooks/useMouseCallbacks.ts","App.tsx","index.tsx"],"names":["getPointFromCell","side","paddingSide","cellSize","Math","floor","useResponsiveSize","container","imgSize","resizeObserverRef","React","useRef","useState","size","setSize","handleResize","useCallback","clientWidth","clientHeight","width","height","aspect","useEffect","current","ResizeObserver","observe","containerSize","canvasSize","setCanvasSize","newImgHeight","isWidest","useCanvasResolution","NOOP","DEFAULT_CTX_STYLES","strokeStyle","lineDashOffset","lineDash","fillStyle","GRID_STYLES","SELECT_AREA_STYLES","CELLS_STYLES","SelectableGrid","onMouseDown","onMouseMove","onMouseUp","gridStyles","selectAreaStyles","cellsStyles","canvasRef","requestIdRef","canvasStyles","top","left","right","bottom","setCanvasStyles","containerWidth","offsetWidth","containerHeight","offsetHeight","canvasWidth","canvasHeight","offsetX","offsetY","styles","useCanvasStyles","paddings","setPaddings","cellCountX","paddingTop","paddingLeft","useCanvasPaddings","isDrag","setIsDrag","startPoint","setStartPoint","x","y","w","h","area","setArea","areaInPx","setAreaInPx","areaInPercent","setAreaInPercent","pLeft","pTop","handleMouseDown","event","nativeEvent","point","handleMouseMove","min","abs","handleMouseUp","useMouseCallbacks","updateCtxStyles","ctx","ctxStyles","setLineDash","drawGrid","getContext","clearRect","beginPath","moveTo","lineTo","stroke","drawSelectArea","strokeRect","fillRect","fillCells","startX","endX","ceil","startY","countX","countY","cellX","cellY","positionX","CELL_OFFSET","positionY","drawTick","requestAnimationFrame","cancelAnimationFrame","ref","className","style","App","containerRef","imgRef","undefined","setImgSize","src","alt","onLoad","currentTarget","naturalWidth","naturalHeight","e","downPosition","console","log","areaInfo","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.d1a32442.chunk.js","sourcesContent":["export const getPointFromCell = (\n  side: number,\n  paddingSide: number,\n  cellSize: number\n) => Math.floor((side - paddingSide) / cellSize) * cellSize + paddingSide\n","import React from 'react'\n\nimport { useCanvasResolution } from './useCanvasResolution'\nimport { Size } from '../types'\n\nexport const useResponsiveSize = ({\n  container,\n  imgSize\n}: {\n  container: HTMLDivElement | null\n  imgSize?: Size\n}) => {\n  const resizeObserverRef = React.useRef<ResizeObserver>()\n  const [size, setSize] = React.useState<{\n    width: number\n    height: number\n    aspect: number\n  }>()\n\n  const handleResize = React.useCallback(() => {\n    if (!container) {\n      return\n    }\n\n    const { clientWidth, clientHeight } = container\n\n    setSize({\n      width: clientWidth,\n      height: clientHeight,\n      aspect: clientWidth / clientHeight\n    })\n  }, [container])\n\n  React.useEffect(() => {\n    if (!resizeObserverRef.current && container) {\n      resizeObserverRef.current = new ResizeObserver(handleResize)\n      resizeObserverRef.current.observe(container)\n    }\n  }, [container, handleResize])\n\n  const canvasSize = useCanvasResolution({ containerSize: size, imgSize })\n\n  return canvasSize\n}\n","import React from 'react'\n\nimport { CanvasSize, Size } from '../types'\n\n// set canvas size\nexport const useCanvasResolution = ({\n  containerSize,\n  imgSize\n}: {\n  containerSize?: Size\n  imgSize?: Size\n}) => {\n  const [canvasSize, setCanvasSize] = React.useState<CanvasSize>({\n    width: 0,\n    height: 0\n  })\n\n  React.useEffect(() => {\n    if (!containerSize || !imgSize) {\n      return\n    }\n\n    const { width, height } = containerSize\n    const { aspect } = imgSize\n\n    const newImgWidth = height * aspect\n    const newImgHeight = width / aspect\n\n    const isWidest = newImgHeight <= height\n\n    const size = {\n      width: isWidest ? width : newImgWidth,\n      height: isWidest ? newImgHeight : height\n    }\n\n    setCanvasSize(size)\n  }, [containerSize, imgSize])\n\n  return canvasSize\n}\n","import * as React from 'react'\n\nimport { getPointFromCell } from './helpers'\nimport {\n  useCanvasPaddings,\n  useCanvasStyles,\n  useMouseCallbacks,\n  useResponsiveSize\n} from './hooks'\nimport {\n  Size,\n  Point,\n  AreaInfo,\n  AreaStyles,\n  CellsStyles,\n  GridStyles,\n  CtxStyles\n} from './types'\nimport styles from './styles.module.css'\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst NOOP = () => {}\n\nconst DEFAULT_CTX_STYLES: CtxStyles = {\n  strokeStyle: 'black',\n  lineDashOffset: 0,\n  lineDash: [0, 0],\n  fillStyle: 'black'\n}\n\nconst GRID_STYLES = {\n  strokeStyle: 'blue',\n  lineDashOffset: 0,\n  lineDash: [5, 5]\n}\n\nconst SELECT_AREA_STYLES = {\n  strokeStyle: 'red',\n  fillStyle: 'rgba(100,0,0,0.3)',\n  lineDash: [0, 0]\n}\n\nconst CELLS_STYLES = {\n  strokeStyle: 'red',\n  fillStyle: 'rgba(100,0,0,0.3)'\n}\ninterface Props {\n  container: HTMLDivElement | null\n  imgSize?: Size\n  cellSize?: number\n  onMouseDown?: (e: React.MouseEvent, startDownPosition: Point) => void\n  onMouseMove?: (e: React.MouseEvent, areaInfo: AreaInfo) => void\n  onMouseUp?: (e: React.MouseEvent, areaInfo: AreaInfo) => void\n  gridStyles?: GridStyles\n  selectAreaStyles?: AreaStyles\n  cellsStyles?: CellsStyles\n}\n\nconst CELL_OFFSET = 5\n\nexport const SelectableGrid = ({\n  container,\n  imgSize,\n  cellSize = 30,\n  onMouseDown = NOOP,\n  onMouseMove = NOOP,\n  onMouseUp = NOOP,\n  gridStyles = GRID_STYLES,\n  selectAreaStyles = SELECT_AREA_STYLES,\n  cellsStyles = CELLS_STYLES\n}: Props) => {\n  const canvasRef = React.useRef<HTMLCanvasElement | null>(null)\n  const requestIdRef = React.useRef<number | null>(null)\n\n  const canvasSize = useResponsiveSize({ container, imgSize })\n  const canvasStyles = useCanvasStyles({ container, canvasSize })\n  const paddings = useCanvasPaddings({ canvasSize, cellSize })\n  const {\n    isDrag,\n    area,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseUp,\n    startPoint\n  } = useMouseCallbacks({\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    canvasSize,\n    cellSize,\n    paddings\n  })\n\n  const updateCtxStyles = (\n    ctx: CanvasRenderingContext2D,\n    ctxStyles: CtxStyles = DEFAULT_CTX_STYLES\n  ) => {\n    const { fillStyle, lineDash, lineDashOffset, strokeStyle } = ctxStyles\n    ctx.fillStyle = fillStyle\n    ctx.setLineDash(lineDash)\n    ctx.lineDashOffset = lineDashOffset\n    ctx.strokeStyle = strokeStyle\n  }\n\n  const drawGrid = React.useCallback(() => {\n    if (!canvasRef.current) {\n      return\n    }\n\n    const ctx = canvasRef.current.getContext('2d')\n\n    if (!ctx) {\n      return\n    }\n\n    const { width, height } = canvasSize\n    const { top, left, right, bottom } = paddings\n\n    ctx.clearRect(0, 0, width, height)\n\n    updateCtxStyles(ctx, { ...DEFAULT_CTX_STYLES, ...gridStyles })\n\n    ctx.beginPath()\n\n    for (let x = left; x <= width - right; x += cellSize) {\n      ctx.moveTo(x, top)\n      ctx.lineTo(x, height - bottom)\n    }\n\n    for (let y = top; y <= height - bottom; y += cellSize) {\n      ctx.moveTo(left, y)\n      ctx.lineTo(width - right, y)\n    }\n\n    ctx.stroke()\n  }, [canvasSize, paddings, gridStyles, cellSize])\n\n  const drawSelectArea = React.useCallback(() => {\n    if (!canvasRef.current) {\n      return\n    }\n\n    const ctx = canvasRef.current.getContext('2d')\n\n    if (!ctx) {\n      return\n    }\n\n    updateCtxStyles(ctx, { ...DEFAULT_CTX_STYLES, ...selectAreaStyles })\n\n    const { x, y, w, h } = area\n\n    ctx.strokeRect(x, y, w, h)\n    ctx.fillRect(x, y, w, h)\n  }, [area, selectAreaStyles])\n\n  const fillCells = React.useCallback(() => {\n    if (!canvasRef.current) {\n      return\n    }\n\n    const ctx = canvasRef.current.getContext('2d')\n\n    if (!ctx) {\n      return\n    }\n\n    if (!startPoint) {\n      return\n    }\n\n    updateCtxStyles(ctx, { ...DEFAULT_CTX_STYLES, ...cellsStyles })\n\n    const { x, y, w, h } = area\n    const { top, left, right, bottom } = paddings\n    const { width, height } = canvasSize\n\n    // TODO: To think about the algorithm for shading cells\n    const startX = Math.floor((x - left) / cellSize)\n    const endX = Math.ceil((x + w - left) / cellSize)\n    const startY = Math.floor((y - top) / cellSize)\n    const endY = Math.ceil((y + h - top) / cellSize)\n\n    const countX = endX - startX\n    const countY = endY - startY\n\n    for (let cellX = 0; cellX < countX; cellX += 1) {\n      for (let cellY = 0; cellY < countY; cellY += 1) {\n        const positionX =\n          getPointFromCell(x + cellSize * cellX, left, cellSize) +\n          CELL_OFFSET / 2\n\n        const positionY =\n          getPointFromCell(y + cellSize * cellY, top, cellSize) +\n          CELL_OFFSET / 2\n\n        // TODO: change the condition\n        if (\n          positionX < left ||\n          positionX > width - right ||\n          positionY < top ||\n          positionY > height - bottom\n        ) {\n          continue\n        }\n\n        ctx.clearRect(\n          positionX,\n          positionY,\n          cellSize - CELL_OFFSET,\n          cellSize - CELL_OFFSET\n        )\n        ctx.fillRect(\n          positionX,\n          positionY,\n          cellSize - CELL_OFFSET,\n          cellSize - CELL_OFFSET\n        )\n      }\n    }\n  }, [startPoint, cellsStyles, area, paddings, canvasSize, cellSize])\n\n  // all draw\n  const drawTick = () => {\n    if (!canvasRef.current) {\n      return\n    }\n\n    const ctx = canvasRef.current.getContext('2d')\n\n    if (!ctx) {\n      return\n    }\n\n    ctx.clearRect(0, 0, canvasSize.width, canvasSize.height)\n\n    drawGrid()\n    fillCells()\n    if (isDrag) {\n      drawSelectArea()\n    }\n\n    requestIdRef.current = requestAnimationFrame(drawTick)\n  }\n\n  React.useEffect(() => {\n    requestIdRef.current = requestAnimationFrame(drawTick)\n    return () => {\n      if (!requestIdRef.current) {\n        return\n      }\n      cancelAnimationFrame(requestIdRef.current)\n    }\n  })\n\n  if (!container || !imgSize) {\n    return null\n  }\n\n  return (\n    <canvas\n      ref={canvasRef}\n      className={styles.canvas}\n      style={{ ...canvasStyles }}\n      width={canvasSize.width}\n      height={canvasSize.height}\n      onMouseDown={handleMouseDown}\n      onMouseUp={handleMouseUp}\n      onMouseMove={handleMouseMove}\n    />\n  )\n}\n","import React from 'react'\n\nimport { CanvasSize } from '../types'\n\n// set canvas styles\nexport const useCanvasStyles = ({\n  container,\n  canvasSize\n}: {\n  container: HTMLDivElement | null\n  canvasSize: CanvasSize\n}) => {\n  const [canvasStyles, setCanvasStyles] = React.useState({\n    top: '0',\n    left: '0',\n    right: '0',\n    bottom: '0'\n  })\n\n  React.useEffect(() => {\n    if (!container || !canvasSize.width || !canvasSize.height) {\n      return\n    }\n\n    const { offsetWidth: containerWidth, offsetHeight: containerHeight } =\n      container\n    const { width: canvasWidth, height: canvasHeight } = canvasSize\n\n    const isOffsetX = canvasWidth <= containerWidth\n    const isOffsetY = canvasHeight <= containerHeight\n\n    const offsetX = isOffsetX ? (containerWidth - canvasWidth) / 2 : 0\n    const offsetY = isOffsetY ? (containerHeight - canvasHeight) / 2 : 0\n\n    const styles = {\n      top: `${(offsetY / containerHeight) * 100}%`,\n      left: `${(offsetX / containerWidth) * 100}%`,\n      right: `${(offsetX / containerWidth) * 100}%`,\n      bottom: `${(offsetY / containerHeight) * 100}%`\n    }\n\n    setCanvasStyles(styles)\n  }, [container, canvasSize])\n\n  return canvasStyles\n}\n","import React from 'react'\n\nimport { CanvasSize, Paddings } from '../types'\n\n// set paddings for grid\nexport const useCanvasPaddings = ({\n  canvasSize,\n  cellSize\n}: {\n  canvasSize: CanvasSize\n  cellSize: number\n}) => {\n  const [paddings, setPaddings] = React.useState<Paddings>({\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0\n  })\n\n  React.useEffect(() => {\n    const { width, height } = canvasSize\n\n    if (!width || !height) {\n      return\n    }\n\n    const cellCountX = Math.floor(width / cellSize)\n    const cellCountY = Math.floor(height / cellSize)\n\n    const paddingX = width - cellCountX * cellSize\n    const paddingY = height - cellCountY * cellSize\n\n    const paddingTop = paddingY / 2 - 0.5\n    const paddingLeft = paddingX / 2 - 0.5\n    const paddingRight = paddingLeft\n    const paddingBottom = paddingTop\n\n    setPaddings({\n      top: paddingTop,\n      left: paddingLeft,\n      right: paddingRight,\n      bottom: paddingBottom\n    })\n  }, [canvasSize, cellSize])\n\n  return paddings\n}\n","import React from 'react'\n\nimport { getPointFromCell } from '../helpers'\nimport {\n  AreaInfo,\n  AreaInPercent,\n  AreaInPx,\n  CanvasSize,\n  Paddings,\n  Point,\n  SelectableArea\n} from '../types'\n\nexport const useMouseCallbacks = ({\n  onMouseDown,\n  onMouseMove,\n  onMouseUp,\n  paddings,\n  canvasSize,\n  cellSize\n}: {\n  onMouseDown: (e: React.MouseEvent, downPosition: Point) => void\n  onMouseMove: (e: React.MouseEvent, areaInfo: AreaInfo) => void\n  onMouseUp: (e: React.MouseEvent, areaInfo: AreaInfo) => void\n  paddings: Paddings\n  canvasSize: CanvasSize\n  cellSize: number\n}) => {\n  const [isDrag, setIsDrag] = React.useState<boolean>(false)\n  const [startPoint, setStartPoint] = React.useState<Point | null>(null)\n  const [area, setArea] = React.useState<SelectableArea>({\n    x: 0,\n    y: 0,\n    w: 0,\n    h: 0\n  })\n  const [areaInPx, setAreaInPx] = React.useState<AreaInPx>({\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0\n  })\n\n  const [areaInPercent, setAreaInPercent] = React.useState<AreaInPercent>({\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0\n  })\n\n  // calculate selected area in px and percent\n  React.useEffect(() => {\n    const { x, y, w, h } = area\n    const { left: pLeft, top: pTop } = paddings\n    const { width, height } = canvasSize\n\n    const left = getPointFromCell(x, pLeft, cellSize)\n    const top = getPointFromCell(y, pTop, cellSize)\n    const right = getPointFromCell(x + w, pLeft, cellSize) + cellSize\n    const bottom = getPointFromCell(y + h, pTop, cellSize) + cellSize\n\n    setAreaInPx({ top, left, right, bottom })\n    setAreaInPercent({\n      top: top / height,\n      left: left / width,\n      right: right / width,\n      bottom: bottom / height\n    })\n  }, [area, paddings, canvasSize, cellSize])\n\n  // reset selectable area when canvas changing own sizes\n  React.useEffect(() => {\n    setIsDrag(false)\n    setStartPoint(null)\n  }, [canvasSize])\n\n  const handleMouseDown = (event: React.MouseEvent) => {\n    const {\n      nativeEvent: { offsetX, offsetY }\n    } = event\n\n    const point = { x: offsetX, y: offsetY }\n\n    setIsDrag(true)\n    setStartPoint(point)\n    setArea({ ...point, w: 0, h: 0 })\n    onMouseDown(event, point)\n  }\n\n  const handleMouseUp = (event: React.MouseEvent) => {\n    setIsDrag(false)\n    onMouseUp(event, { area, areaInPx, areaInPercent })\n  }\n\n  const handleMouseMove = (event: React.MouseEvent) => {\n    const {\n      nativeEvent: { offsetX, offsetY }\n    } = event\n\n    if (!isDrag) {\n      return\n    }\n\n    if (!startPoint) {\n      return\n    }\n\n    const area = {\n      x: Math.min(offsetX, startPoint.x),\n      y: Math.min(offsetY, startPoint.y),\n      w: Math.abs(offsetX - startPoint.x),\n      h: Math.abs(offsetY - startPoint.y)\n    }\n\n    setArea(area)\n\n    onMouseMove(event, { area, areaInPx, areaInPercent })\n  }\n\n  return {\n    isDrag,\n    area,\n    startPoint,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseUp\n  }\n}\n","import React, { useRef, useState } from 'react'\n\nimport { SelectableGrid } from 'selectable-grid'\nimport 'selectable-grid/dist/index.css'\nimport { Point, AreaInfo, Size } from '../../dist/types'\n\nconst App = () => {\n  const containerRef = useRef<HTMLDivElement>(null)\n  const imgRef = useRef<HTMLImageElement>(null)\n  const [imgSize, setImgSize] = useState<Size | undefined>(undefined)\n\n  const handleLoad = ({\n    currentTarget: { naturalWidth, naturalHeight }\n  }: React.SyntheticEvent<HTMLImageElement>) => {\n    setImgSize({\n      width: naturalWidth,\n      height: naturalHeight,\n      aspect: naturalWidth / naturalHeight\n    })\n  }\n\n  return (\n    <div ref={containerRef} className='container'>\n      <img\n        className='img'\n        ref={imgRef}\n        src='https://all-t-shirts.ru/goods_images/ru110593II00039d6336575d4ab6f3960422a337e0e78.jpg'\n        alt=''\n        onLoad={handleLoad}\n      />\n\n      <SelectableGrid\n        container={containerRef.current}\n        imgSize={imgSize}\n        onMouseDown={(e: React.MouseEvent, downPosition: Point) => {\n          console.log('event => ', e)\n          console.log('downPosition => ', downPosition)\n        }}\n        onMouseMove={(e: React.MouseEvent, areaInfo: AreaInfo) => {\n          console.log('event => ', e)\n          console.log('ðŸš€ ~ areaInfo', areaInfo)\n        }}\n        onMouseUp={(e: React.MouseEvent, areaInfo: AreaInfo) => {\n          console.log('event => ', e)\n          console.log('ðŸš€ ~ areaInfo', areaInfo)\n        }}\n      />\n    </div>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}